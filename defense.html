<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palworld Combat</title>
    <link rel="stylesheet" href="./styles/combat.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&family=Lilita+One&family=Nova+Square&family=Rowdies:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="header-menu">
       
        <div class="header">
            <h1>Palworld Combat</h1>
        </div>
        <button class="hamburger" onclick="toggleMenu()">â˜°</button>
        <div class="menu-overlay" id="menuOverlay">
            <button class="close-btn" onclick="toggleMenu()">x</button>
            <div class="menu-content">
                <a href="./index.html" class="inactive">Landing Page</a>
                <a href="./combat.html" class="inactive">Combat</a>
                <a href="./defense.html" class="active">Defense</a>
                <a href="./bestMoves.html" class="inactive">Best Moves</a>
            </div>
        </div>
        <div class="menu">
            <a href="./index.html" class="inactive">Landing Page</a>
            <a href="./combat.html" class="inactive">Combat</a>
            <a href="./defense.html" class="active">Defense</a>
            <a href="./bestMoves.html" class="inactive">Best Moves</a>
        </div>
    </div>
    <div class="content">
        <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Search for names...">
        <table id="data-table">
            <thead>
                <tr>
                    <th onclick="sortTable(0)">Pal</th>
                    <th onclick="sortTable(1)">Type</th>
                    <th onclick="sortTable(2)">Level 50 HP</th>
                    <th onclick="sortTable(3)">Level 50 HP Score*</th>
                    <th onclick="sortTable(4)">Level 50 Attack</th>
                    <th onclick="sortTable(5)">Level 50 Defense</th>
                    <th onclick="sortTable(6)">Combat Score</th>
                    <th onclick="sortTable(7)">STAB Attack</th>
                    <th onclick="sortTable(8)">STAB Combat Score</th>
                    <th onclick="sortTable(9)">Type Atk (STAB)</th>
                    <th onclick="sortTable(10)">Type Def</th>
                    <th onclick="sortTable(11)">Type CmbScr (STAB)</th>
                    <th onclick="sortTable(12)">Type Atk (no STAB)</th>
                    <th onclick="sortTable(13)">Type CmbScr (no STAB)</th>
                    <th onclick="sortTable(14)">Best for</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data rowswill be inserted here by JavaScript -->
            </tbody>
        </table>
        </div>
        <select id="palSelector" onchange="displayPalData()">
            <!-- Options will be populated by JavaScript -->
        </select>
    
        <div id="palDetails" style="display:none;">
            <h2 id="detailName"></h2>
            <p>Level 50 HP: <span id="detailHp"></span></p>
            <p>Level 50 HP Score*: <span id="detailHpScore"></span></p>
            <p>Level 50 Attack: <span id="detailAttack"></span></p>
            <p>Level 50 Defense: <span id="detailDefense"></span></p>
            <!-- Add more fields as needed -->
        </div>    </div>
</body>

<script>
    async function loadData() {
        try {
            const response = await fetch('https://sheetlabs.com/ACC/PalCombatData');
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            const data = await response.json();
            populateTable(data);
        } catch (error) {
            console.error('Error loading data:', error);
            document.body.insertAdjacentHTML('beforeend', `<div style="
    padding-left: 20px; padding-right: 20px;
"><p style="
    text-align: center;
">There was a problem loading the data. Please try again later.</p></div>`);
        }
    }

    function populateTable(data) {
        const tableBody = document.getElementById('data-table').getElementsByTagName('tbody')[0];
        data.forEach(item => {
            let row = tableBody.insertRow();
            Object.values(item).forEach(text => {
                let cell = row.insertCell();
                cell.textContent = text;
            });
        });
    }

    function sortTable(column) {
let table = document.getElementById('data-table');
let rows = Array.from(table.rows).slice(1);
let isAscending = table.getAttribute('data-sort-dir') === 'asc' && table.getAttribute('data-sort-col') === column.toString();
let dir = isAscending ? -1 : 1;
table.setAttribute('data-sort-dir', isAscending ? 'desc' : 'asc');
table.setAttribute('data-sort-col', column.toString());

// Determine if the column should be sorted as numbers or strings
let isNumeric = rows.every(row => !isNaN(parseFloat(row.cells[column].innerText)) && isFinite(row.cells[column].innerText));

rows.sort((a, b) => {
    let x = a.cells[column].innerText.toLowerCase();
    let y = b.cells[column].innerText.toLowerCase();

    if (isNumeric) {
        x = parseFloat(x);
        y = parseFloat(y);
    }

    return (x < y ? -1 : (x > y ? 1 : 0)) * dir;
});

for (let i = 0; i < rows.length; i++) {
    table.tBodies[0].appendChild(rows[i]);
}

document.querySelectorAll('th').forEach(th => th.classList.remove('ascending', 'descending'));
document.querySelectorAll('th')[column].classList.add(isAscending ? 'descending' : 'ascending');
}

    function searchTable() {
        let input = document.getElementById("searchInput");
        let filter = input.value.toLowerCase();
        let table = document.getElementById("data-table");
        let tr = table.getElementsByTagName("tr");

        for (let i = 1; i < tr.length; i++) {
            tr[i].style.display = "none"; // Hide all rows initially
            let td = tr[i].getElementsByTagName("td");
            for (let j = 0; j < td.length; j++) {
                if (td[j].textContent.toLowerCase().indexOf(filter) > -1) {
                    tr[i].style.display = ""; // Show the row where a match is found
                    break; // Stop loop if a match is found
                }
            }
        }
    }

    window.onload = loadData;

    function toggleMenu() {
    var overlay = document.getElementById('menuOverlay');
    if (overlay.style.display === 'block') {
        overlay.style.display = 'none';
    } else {
        overlay.style.display = 'block';
    }
}

</script>
</html>
